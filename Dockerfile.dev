# Development Dockerfile for XKids Learning Center
# Uses the same base as production but with live reloading capabilities

FROM nginx:alpine

# Set maintainer information
LABEL maintainer="Exrienz <muzaffar.mohamed@example.com>"
LABEL description="XKids Learning Center - Educational apps for children (Development Mode)"
LABEL version="1.0.0"

# Remove default nginx website
RUN rm -rf /usr/share/nginx/html/*

# Copy custom nginx configuration
COPY docker/nginx/nginx.conf /etc/nginx/nginx.conf
COPY docker/nginx/security.conf /etc/nginx/conf.d/security.conf
COPY docker/nginx/default.conf /etc/nginx/conf.d/default.conf

# Install curl for healthcheck
RUN apk add --no-cache curl

# Create a healthcheck script
RUN echo '#!/bin/sh' > /usr/local/bin/healthcheck.sh && \
    echo 'curl -f http://localhost/health || exit 1' >> /usr/local/bin/healthcheck.sh && \
    chmod +x /usr/local/bin/healthcheck.sh

# Expose port 80
EXPOSE 80

# Start nginx
CMD ["nginx", "-g", "daemon off;"]